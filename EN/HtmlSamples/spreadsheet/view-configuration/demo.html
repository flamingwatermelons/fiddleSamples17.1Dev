<script src="http://dev.igniteui.local/17-1/js/modernizr.min.js"></script>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
<script src="http://dev.igniteui.local/17-1/IgniteUI/js/infragistics.loader.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
	<div class="actions spreadsheet-sample" id="tabs">
		<ul>
			<li><a href="#tabs-1">Show</a></li>
			<li><a href="#tabs-2">Zoom Level</a></li>
			<li><a href="#tabs-3">Sheet</a></li>
			<li><a href="#tabs-4">Formatting</a></li>
			<li><a href="#tabs-5">Delete</a></li>
		</ul>

		<div class="show clearfix" id="tabs-1">
			<div class="show-row">
                <span for="gridlines" class="show-row-text">
                    <div id="gridlines" class="show-row-checkbox"></div>
                    Gridlines
                </span>
            </div>
            <div class="show-row">
                <span for="headings" class="show-row-text">
                    <div id="headings" class="show-row-checkbox"></div>
                    Headings
                </span>
            </div>
            <div class="show-row">
                <span for="formulabar" class="show-row-text">
                    <div id="formulabar" class="show-row-checkbox"></div>
                    Formula bar
                </span>
            </div>
        </div>

		<div class="zoom clearfix" id="tabs-2">
			<div class="clearfix zoom-slider f-left">
                <div id="zoomOut" class="spreadsheet-sample-btn"> Zoom Out</div>
                <div id="zoomSlider"></div>
                <div id="zoomIn" class="spreadsheet-sample-btn">Zoom In</div>
                  
            </div>
			<div class="f-left">
                <div id="zoom" class="spreadsheet-sample-btn"> Zoom 100%</div>
                <div id="zoomSelection" class="spreadsheet-sample-btn">Zoom Selection</div>
            </div>
		</div>

		<div class="sheet clearfix" id="tabs-3">
			<div id="freeze"></div>
			<div id="split" class="spreadsheet-sample-btn">Split</div>
		</div>

		<div class="formatting clearfix" id="tabs-4">
			<div id="bold" class="spreadsheet-sample-btn">Bold</div>
			<div id="italic" class="spreadsheet-sample-btn">Italic</div>
			<div id="underline" class="spreadsheet-sample-btn">Underline</div>
		</div>

		<div class="delete clearfix" id="tabs-5">
			<div id="delSheet" class="spreadsheet-sample-btn">Delete Sheet</div>
			<div id="delContent" class="spreadsheet-sample-btn">Delete Content</div>
		</div>

	</div>
	<div id="spreadsheet2"></div>
	<script type="text/javascript">
		$.ig.loader({
			scriptPath: "../../igniteui/js/",
			cssPath: "../../igniteui/css/",
			resources: "igSpreadsheet,igExcel.LoadSaveXlsx,igEditors",
			ready: function () {
				if ($("#spreadsheet2").length !== 0) {
					$("#tabs").tabs();
					$("#spreadsheet2").igSpreadsheet({
						height: "600",
						width: "100%"
					});

					var workbook = null;
					var xhr = new XMLHttpRequest();
					xhr.open('GET', '../../data-files/FormattingData.xlsx', true);
					xhr.responseType = 'arraybuffer';

					xhr.onload = function (e) {
						// response is unsigned 8 bit integer
						var responseArray = new Uint8Array(this.response);
						$.ig.excel.Workbook.load(responseArray, function () {
							workbook = arguments[0];
							$("#spreadsheet2").igSpreadsheet("option", "workbook", workbook);
						}, function () {
							console.log("fail");
						})
					};

					xhr.send();

					$("#zoomSlider").slider({
						change: function (event, ui) {
							$("#spreadsheet2").igSpreadsheet("option", "zoomLevel", ui.value);
						},
						min: 10,
						max: 400,
						value: 100,
						step: 1
					});

					$("#zoomIn").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "zoomIn");
						var zoomInLevel = $('#spreadsheet2').igSpreadsheet('option', "zoomLevel");
						$("#zoomSlider").slider("value", zoomInLevel);
					});
					$("#zoomOut").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "zoomOut");
						var zoomOutLevel = $('#spreadsheet2').igSpreadsheet('option', "zoomLevel");
						$("#zoomSlider").slider("value", zoomOutLevel);
					});
					$("#zoom").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "zoomTo100");
						var zoomLevel = $('#spreadsheet2').igSpreadsheet('option', "zoomLevel");
						$("#zoomSlider").slider("value", zoomLevel);
					});
					$("#zoomSelection").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "zoomToSelection");
						var zoomSelectionLevel = $('#spreadsheet2').igSpreadsheet('option', "zoomLevel");
						$("#zoomSlider").slider("value", zoomSelectionLevel);
					});

					$("#split").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "toggleSplitPanes");
					});

					$("#gridlines").igCheckboxEditor({
						checked: true,
						valueChanged: function (evt, ui) {
							if (ui.newState) {
								$("#spreadsheet2").igSpreadsheet("option", "areGridlinesVisible", true);
							} else {
								$("#spreadsheet2").igSpreadsheet("option", "areGridlinesVisible", false);
							}
						}
					});
					$("#headings").igCheckboxEditor({
						checked: true,
						valueChanged: function (evt, ui) {
							if (ui.newState) {
								$("#spreadsheet2").igSpreadsheet("option", "areHeadersVisible", true);
							} else {
								$("#spreadsheet2").igSpreadsheet("option", "areHeadersVisible", false);
							}
						}
					});
					$("#formulabar").igCheckboxEditor({
						checked: true,
						valueChanged: function (evt, ui) {
							if (ui.newState) {
								$("#spreadsheet2").igSpreadsheet("option", "isFormulaBarVisible", true);
							} else {
								$("#spreadsheet2").igSpreadsheet("option", "isFormulaBarVisible", false);
							}
						}
					});
					var listItems = [{ id: 1, action: "freeze pane" }, { id: 2, action: "freeze first row" }, { id: 3, action: "freeze first column" }];
					$("#freeze").igCombo({
						dataSource: listItems,
						textKey: "action",
						valueKey: "id",
						width: "150px",
						autoSelectFirstMatch: false,
						selectionChanged: function (evt, ui) {
							if (ui.items[0].data.id == 1) {
								if (ui.items[0].data.action == "unfreeze pane") {
									listItems[0].action = "freeze pane";
									$("#freeze").igCombo("dataBind");
								} else {
									listItems[0].action = "unfreeze pane";
									$("#freeze").igCombo("dataBind");
								}
								$('#spreadsheet2').igSpreadsheet('executeAction', "toggleFreezePanes");
							} else if (ui.items[0].data.id == 2) {
								$('#spreadsheet2').igSpreadsheet('executeAction', "freezeFirstRow");
								listItems[0].action = "unfreeze pane";
								$("#freeze").igCombo("dataBind");
							} else {
								$('#spreadsheet2').igSpreadsheet('executeAction', "freezeFirstColumn");
								listItems[0].action = "unfreeze pane";
								$("#freeze").igCombo("dataBind");
							}
						}
					});
					$("#delSheet").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "deleteWorksheets");
					});
					$("#delContent").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "clearContents");
					});
					$("#bold").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "toggleBold");
					});
					$("#italic").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "toggleItalic");
					});
					$("#underline").click(function () {
						$('#spreadsheet2').igSpreadsheet('executeAction', "toggleUnderline");
					});
				}
			}
		});
	</script>
</link>

